<ContentPage
    x:Class="A_Connect.Views.ProfsToPickNewsFeedPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Profs to Pick News Feed"
    BackgroundColor="White">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 1. Blue Header -->
        <Grid BackgroundColor="#063970" Padding="20,40,20,20">
            <Label Text="Profs to Pick"
                   TextColor="Gold"
                   FontAttributes="Bold"
                   FontSize="24"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"/>
        </Grid>

        <!-- 2. Main Content -->
        <StackLayout Grid.Row="1" Spacing="15" Padding="20">

            <!-- Search Bar -->
            <Frame CornerRadius="25" BackgroundColor="White" Padding="0">
                <HorizontalStackLayout Padding="10,0">
                    <Image Source="search_icon.png"
                           HeightRequest="20"
                           WidthRequest="20"
                           VerticalOptions="Center"
                           Margin="0,0,5,0"/>
                    <Entry Text="{Binding SearchText, Mode=TwoWay}" 
                           Placeholder="Search"
                           VerticalOptions="Center"
                           FontSize="14"
                           Margin="0"/>
                </HorizontalStackLayout>
            </Frame>

            <!-- Tab-like buttons -->
            <Grid ColumnSpacing="0" RowSpacing="0" Padding="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Button Text="Posts by other users"
                        BackgroundColor="#F0F0F0"
                        TextColor="Black"
                        Grid.Column="0"
                        CornerRadius="0"
                        FontAttributes="Bold"/>
                <Button Text="Own posts"
                        BackgroundColor="#F0F0F0"
                        TextColor="Black"
                        Grid.Column="1"
                        CornerRadius="0"
                        FontAttributes="Bold"/>
            </Grid>

            <!-- ðŸ”¥ Reviews List (Dynamic) -->
            <RefreshView Command="{Binding LoadReviewsCommand}">
                <CollectionView ItemsSource="{Binding Reviews}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <StackLayout Margin="0,10">
                                <Frame BackgroundColor="#1F6FB7"
                                       CornerRadius="15"
                                       Padding="15">
                                    <VerticalStackLayout Spacing="5">
                                        <Label Text="{Binding CourseCode}"
                                               TextColor="White"
                                               FontSize="16"
                                               FontAttributes="Bold"/>

                                        <Label Text="{Binding ProfessorName}"
                                               TextColor="White"
                                               FontSize="14"
                                               FontAttributes="Bold"/>

                                        <!-- Star Ratings -->
                                        <HorizontalStackLayout>
                                            <Image Source="star_filled.png"
                                                   WidthRequest="16" HeightRequest="16"
                                                   IsVisible="{Binding Rating, Converter={StaticResource RatingToStarVisibility}, ConverterParameter=1}"/>
                                            <Image Source="star_filled.png"
                                                   WidthRequest="16" HeightRequest="16"
                                                   IsVisible="{Binding Rating, Converter={StaticResource RatingToStarVisibility}, ConverterParameter=2}"/>
                                            <Image Source="star_filled.png"
                                                   WidthRequest="16" HeightRequest="16"
                                                   IsVisible="{Binding Rating, Converter={StaticResource RatingToStarVisibility}, ConverterParameter=3}"/>
                                            <Image Source="star_filled.png"
                                                   WidthRequest="16" HeightRequest="16"
                                                   IsVisible="{Binding Rating, Converter={StaticResource RatingToStarVisibility}, ConverterParameter=4}"/>
                                            <Image Source="star_filled.png"
                                                   WidthRequest="16" HeightRequest="16"
                                                   IsVisible="{Binding Rating, Converter={StaticResource RatingToStarVisibility}, ConverterParameter=5}"/>
                                        </HorizontalStackLayout>

                                        <!-- Review Content -->
                                        <Label Text="{Binding Content}"
                                               TextColor="White"
                                               FontSize="12"
                                               MaxLines="2"/>

                                        <!-- Date Posted -->
                                        <Label Text="{Binding DatePosted, StringFormat='Date: {0:MMMM dd, yyyy}'}"
                                               TextColor="White"
                                               FontSize="10"
                                               HorizontalOptions="End"/>
                                    </VerticalStackLayout>
                                </Frame>
                            </StackLayout>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </RefreshView>

            <!-- "Post a review" button -->
            <Button Text="Post a review +"
                    BackgroundColor="#F1C40F"
                    TextColor="Black"
                    FontAttributes="Bold"
                    CornerRadius="25"
                    HorizontalOptions="Center"
                    Padding="10,5"
                    Clicked="OnPostReviewClicked"/>
        </StackLayout>

        <!-- 3. Bottom Nav Bar -->
        <Grid Grid.Row="2" BackgroundColor="#063970" HeightRequest="60">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ImageButton Source="nav_icon1.png"
                         Grid.Column="0"
                         HorizontalOptions="Center"
                         VerticalOptions="Center"
                         WidthRequest="30" HeightRequest="30"/>
            <ImageButton Source="nav_home.png"
                         Grid.Column="1"
                         HorizontalOptions="Center"
                         VerticalOptions="Center"
                         WidthRequest="30" HeightRequest="30"/>
            <ImageButton Source="nav_profile.png"
                         Grid.Column="2"
                         HorizontalOptions="Center"
                         VerticalOptions="Center"
                         WidthRequest="30" HeightRequest="30"/>
        </Grid>
    </Grid>
</ContentPage>
